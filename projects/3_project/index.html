<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> An Invariant Representation of Coupler Curves using a Variational AutoEncoder - Application to Path Synthesis of Four-Bar Mechanisms | Anar Nurizada </title> <meta name="author" content="Anar Nurizada"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://anarnuri.github.io/projects/3_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Anar</span> Nurizada </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">Resume </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post-container"> <header class="post-header"> <h1 class="post-title">An Invariant Representation of Coupler Curves using a Variational AutoEncoder - Application to Path Synthesis of Four-Bar Mechanisms</h1> </header> <article class="post-content"> <h2 id="representation-and-synthesis-of-coupler-curves-of-planar-mechanisms-using-deep-neural-networks">Representation and Synthesis of Coupler Curves of Planar Mechanisms using Deep Neural Networks</h2> <p>This paper focuses on the representation and synthesis of coupler curves of planar mechanisms using a deep neural network. The study compares four commonly used features or representations of four-bar coupler curves: Fourier descriptors, wavelets, point coordinates, and images. The results demonstrate that these diverse representations can be unified using a generative AI framework called Variational Autoencoder (VAE). This study shows that a VAE can provide a standalone representation of a coupler curve, regardless of the input representation, and that the compact latent dimensions of the VAE can be used to describe coupler curves of four-bar linkages. Additionally, a new approach that utilizes a VAE in conjunction with a fully connected neural network to generate dimensional parameters of four-bar linkage mechanisms is proposed. This research presents a novel opportunity for automated conceptual design of mechanisms for robots and machines.</p> <h3 id="introduction">Introduction</h3> <p>The challenge of path generation, which involves synthesis of linkage mechanisms, such as four-bar and higher-order ones, to follow a sequence of consecutive points (x_i, y_i) in R^2, has been the subject of numerous studies, yielding a multitude of proposed solutions. Often these solutions hinge on optimization approaches. These methods represent the coupler point path by precision points and utilize an objective function to minimize the error between them. Despite their prevalent use, they suffer from significant drawbacks, including slow optimization, dependence on initial conditions, and lack of guaranteed results, often failing to capture the true shape of a given path.</p> <p>The complexity of these mechanisms is further emphasized by the nonlinear relationships between input and dimensional parameters. Even minor changes to the input can lead to a significantly different mechanism. In the context of coupler-curve generation for a four-bar linkage synthesis, the problem appears to be defined but is often considered over-determined, leaving the synthesis problem without an analytical solution. As the number of links in a mechanism grows beyond the simplicity of a four-bar linkage, it enables the production of more complex motions, which makes the design of such linkages considerably more challenging compared to four-bar linkages.</p> <p>Due to these reasons, there has been a growing interest in using neural networks (NNs) for mechanism synthesis. NNs are widely recognized for their ability to approximate a class of mappings defined in Euclidean space. This further translates to their application in learning a mapping from design specifications of mechanism design problems to the dimensional parameters of mechanisms. The use of NNs in mechanism synthesis is motivated by a desire to address fundamental issues that lack analytical or theoretical foundations, such as synthesizing circuit-, branch-, and order-defect-free mechanisms, translating user intent into well-defined problems, and satisfying additional kinematic and geometric constraints.</p> <p>Variational AutoEncoders (VAEs), a class of generative deep neural network models, offer the potential to approximate these non-linear relationships more effectively. Unlike conventional optimization methods, VAEs can provide a comprehensive representation of the entire path shape, offering numerous stable solutions. Once trained, VAEs eliminate the need for initial guesses, generate approximations from defect-free datasets, and provide a more robust response to minor input changes. Consequently, VAEs present a promising avenue for the synthesis of closed-loop linkage mechanisms, extending the potential for designing more complex systems with greater accuracy and efficiency.</p> <p>A key challenge in the use of NNs for mechanism synthesis is the representation of mechanisms and their properties, which form a non-Euclidean space. In the case of planar four-bar mechanisms, a crucial property is the coupler curve generated by a floating link. To date, most researchers using NNs have utilized a Euclidean embedding of the input path, leading to various representations of the input coupler curves, including point coordinates, Fourier descriptors, wavelets, and 2D pixel representations in an image. Of these, Fourier and wavelet representations are derived from the point coordinates only, and therefore, they can be considered features instead. However, for simplicity, we will forego this distinction and call them representations only for the purpose of this paper. Despite these representations having produced effective outcomes, there have been no studies investigating the relative merits of different representations and their impact on linkage mechanism synthesis. This lack of knowledge has impeded the field’s progress in using modern machine learning algorithms for mechanism synthesis.</p> <h3 id="approach-and-methodology">Approach and Methodology</h3> <p>This paper presents a machine learning approach for the generation of four-bar linkages that approximate a desired coupler curve. The approach uses a VAE and a Fully Connected Neural Network (FCNN) to generate a multitude of possible linkages. Four widely-utilized representations, namely Fourier descriptors, wavelets, point coordinates, and image-based representations, were investigated.</p> <p>The input (desired) coupler curve is normalized to make it invariant with respect to translation, rotation, and scale. Each of the four representations is then fed to their respective pre-trained VAEs, which map the input curve to a latent space. The k-Nearest Neighbor (k-NN) search in the latent space yields k similar coupler curves represented as latent points. These k latent representations are input to a fully connected neural network to generate k mechanisms. This is a major difference between the previous approaches which would only yield a single mechanism for a desired coupler curve. The use of the VAE allows us to cluster similar looking coupler curves together, thus, providing us with several mechanisms approximating the input curve. This process is illustrated in the figure above.</p> <p>The generated coupler curves were compared to the desired coupler curves by computing the mean square error (MSE). The representation with the lowest MSE was determined to be the most optimal representation. It is important to point out the initial starting points of the mechanisms compared are the same, thus, there is a one-to-one mapping between the points of two curves compared. In case the initial starting points of the two curves would be different, the MSE for two exactly similar curves would be high. In those cases, it would be necessary to consider other methods of curve comparison, such as Frechet Distance, Dynamic Time Warping, etc.</p> <h3 id="results">Results</h3> <p>The results demonstrate that all of the representations yield comparable outcomes, with the MSE values obtained from the wavelet- and point coordinates-based approaches being the lowest and similar to each other. Although the Fourier- and image-based approaches yielded higher MSE values, the generated linkages still provided a reasonable approximation of the input coupler curves. The MSE served as a useful and meaningful metric because the compared curves were closed and subsequently sampled and parameterized identically.</p> <p>The results also indicate that the VAE can serve as a standalone representation of a coupler curve and that a 5D latent space of the VAE is sufficient to describe a coupler curve of a four-bar linkage. It is crucial to emphasize that there is no inherent relationship between the latent space and the actual characteristics of the coupler curves. This gives rise to the possibility of using latent space as the invariant description of coupler curves, which normalizes several different representations used in the literature.</p> <p>The results of this study suggest that all of the representations generate several mechanisms that approximate the input coupler curve well and produce comparable outcomes. The similarities among the mechanisms generated using different representations indicate that the latent space of a Variational Autoencoder (VAE) can be used as an invariant representation of a coupler curve. The kNN search in the latent space, which led to similar curves and their mechanisms, provides evidence that this mapping is locally Euclidean.</p> <p>This paper also explores the effects of linear interpolation between two random curve latent representations. Previous research has shown that reconstructing the interpolated latent representations directly from a VAE can result in unrealistic artifacts. In contrast, this study demonstrates that utilizing a Fully Connected Neural Network (FCNN) in conjunction with a VAE can overcome this problem by ignoring the decoder and producing coupler curves that smoothly morph from one input coupler curve to another, resulting in mechanisms that transform from one to another without singularity.</p> <h3 id="contributions">Contributions</h3> <p>This work makes two key contributions to the field. First, it investigates and compares effective representations of four-bar coupler curves and demonstrates that a normalized representation using a VAE can simplify storage and computation. Second, it proposes a combined VAE-FCNN architecture that learns an effective mapping from the task space (path) to the mechanism (dimensional parameters) and produces four-bar mechanisms by sampling and interpolating in the latent space of the VAE. Although this paper primarily focuses on the most widely-used planar four-bar mechanisms, the approach presented can be extended to high-order single-degree-of-freedom mechanisms.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/figure_3-480.webp 480w,/assets/img/figure_3-800.webp 800w,/assets/img/figure_3-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/figure_3.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="our image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> An input curve consisting out of 360 (x, y) points is normalized, i.e., translated, scaled and rotated. Once normalized, one of the representations, for example wavelet descriptors, is computed and fed into the trained VAE which maps it to its latent space. Performing k-NN search in the latent space yields k latent vectors of coupler curves similar to the desired coupler curve. Taking these latent representations through a fully-connected neural network yields k mechanisms that approximate the desired input coupler curves. The output of the NN is a vector of unknown joint coordinates of mechanisms. </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Anar Nurizada. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: May 16, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script src="/assets/js/shortcut-key.js"></script> </body> </html>